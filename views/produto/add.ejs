<%- include('../cabecalho.ejs') %>

<h1>Adicionar Produto</h1>
<a href="/produto/lst">Listar Produtos</a>

<form method="post" enctype="multipart/form-data">
    <label>ID do Produto:</label>
    <input type="text" name="id_produto" required><br>

    <label>Nome:</label>
    <input type="text" name="nome" required><br>

    <label>Preço:</label>
    <input type="number" step="0.01" name="preco" required><br>

    <label>Categoria:</label>
    <input type="text" name="categoria" required><br>

    <label>Descrição:</label>
    <input type="text" name="descricao" required><br>

    <label>Cafeteria:</label>
    <select name="cafeteria" required>
        <option value="">Selecione a cafeteria</option>
        <% if (Cafeteria && Cafeteria.length) { Cafeteria.forEach(c => { %>
            <option value="<%= c._id %>"><%= c.nome %></option>
        <% }) } %>
    </select><br>

    <label>Imagem do produto:</label>
    <input type="file" name="imagem" id="imagemInputAdd" accept="image/*"><br>
    <img id="previewAdd" src="#" alt="Pré-visualização" style="display:none;max-width:200px;margin-top:8px;border-radius:8px;border:1px solid #ddd;" />

    <button type="submit">Cadastrar</button>
</form>

<script>
document.getElementById('imagemInputAdd').addEventListener('change', function(e){
    const [file] = this.files;
    const preview = document.getElementById('previewAdd');
    if (file) {
        const reader = new FileReader();
        reader.onload = (ev) => {
            preview.src = ev.target.result;
            preview.style.display = 'block';
        };
        reader.readAsDataURL(file);
    } else {
        preview.src = '#';
        preview.style.display = 'none';
    }
});
</script>

<%- include('../rodape.ejs') %>